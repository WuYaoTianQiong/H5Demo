# 公共组件样式规范文档

> 本文档记录项目中复用的公共组件样式，确保跨项目开发时保持一致的设计风格。

---

## 设计规范概览

### 主题色系

```scss
:root {
  --primary-color: #ff6b6b;
  --primary-light: #ff8e53;
  --primary-gradient: linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%);
  --primary-hover: #ffb8a8;
  --primary-shadow: rgba(255, 107, 107, 0.35);
}
```

### 通用变量

```scss
:root {
  --text-primary: #333;
  --text-secondary: #444;
  --text-tertiary: #666;
  --text-muted: #999;

  --bg-primary: #ffffff;
  --bg-secondary: #fafafa;
  --bg-tertiary: #f5f5f0;

  --border-color: #e8e8e8;
  --border-light: #f0f0f0;

  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.02);
  --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 25px 80px rgba(0, 0, 0, 0.18);

  --radius-sm: 8px;
  --radius-md: 10px;
  --radius-lg: 12px;
  --radius-xl: 16px;
  --radius-full: 24px;

  --transition-fast: 0.2s ease;
  --transition-base: 0.3s ease;
}
```

### 颜色变量说明与自定义

#### 主色调变量

| 变量名               | 默认值                                      | 说明                        |
| -------------------- | ------------------------------------------- | --------------------------- |
| `--primary-color`    | `#ff6b6b`                                   | 主色，用于按钮、链接、强调  |
| `--primary-light`    | `#ff8e53`                                   | 主色渐变终点，用于hover效果 |
| `--primary-gradient` | `linear-gradient(135deg, #ff6b6b, #ff8e53)` | 渐变背景                    |
| `--primary-hover`    | `#ffb8a8`                                   | hover状态边框色             |
| `--primary-shadow`   | `rgba(255, 107, 107, 0.35)`                 | 主色阴影                    |

#### 自定义主题色方法

要更换项目主题色，只需修改 `src/styles/variables.scss`：

```scss
/* 示例：改为蓝色主题 */
:root {
  --primary-color: #4d96ff;
  --primary-light: #6bb6ff;
  --primary-gradient: linear-gradient(135deg, #4d96ff 0%, #6bb6ff 100%);
  --primary-hover: #a8d4ff;
  --primary-shadow: rgba(77, 150, 255, 0.35);
}
```

#### 辅助色变量

```scss
:root {
  /* 成功色 */
  --success-color: #52c41a;
  --success-light: #73d13d;
  --success-gradient: linear-gradient(135deg, #52c41a 0%, #73d13d 100%);

  /* 警告色 */
  --warning-color: #faad14;
  --warning-light: #ffc53d;

  /* 错误色 */
  --error-color: #ff4d4f;
  --error-light: #ff7875;

  /* 信息色 */
  --info-color: #1890ff;
  --info-light: #69c0ff;
}
```

---

## 一、骨架屏 Loading 组件

骨架屏用于数据加载时展示占位效果，提供流畅的视觉过渡。

### 1.1 核心动画

```scss
@keyframes skeleton-loading {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}
```

### 1.2 基础骨架元素样式

```scss
.skeleton-base {
  background: linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  border-radius: 4px;
  animation: skeleton-loading 1.5s infinite;
}
```

### 1.3 卡片列表骨架屏

**模板代码：**

```vue
<div v-if="loading" class="skeleton-grid">
  <div v-for="i in 6" :key="i" class="skeleton-trip-card">
    <div class="skeleton-image"></div>
    <div class="skeleton-content">
      <div class="skeleton-title"></div>
      <div class="skeleton-meta">
        <div class="skeleton-meta-item"></div>
        <div class="skeleton-meta-item"></div>
      </div>
      <div class="skeleton-tags">
        <div class="skeleton-tag"></div>
        <div class="skeleton-tag"></div>
      </div>
    </div>
  </div>
</div>
```

**样式代码：**

```scss
.skeleton-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
  width: 100%;
  padding-bottom: 14px;
}

.skeleton-trip-card {
  background: white;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
}

.skeleton-image {
  width: 100%;
  height: 160px;
  background: linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s infinite;
}

.skeleton-content {
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.skeleton-title {
  width: 80%;
  height: 20px;
  background: linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  border-radius: 4px;
  animation: skeleton-loading 1.5s infinite;
}

.skeleton-meta {
  display: flex;
  gap: 16px;
}

.skeleton-meta-item {
  width: 60px;
  height: 14px;
  background: linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  border-radius: 4px;
  animation: skeleton-loading 1.5s infinite;
}

.skeleton-tags {
  display: flex;
  gap: 8px;
}

.skeleton-tag {
  width: 50px;
  height: 24px;
  background: linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  border-radius: 12px;
  animation: skeleton-loading 1.5s infinite;
}
```

### 1.4 垂直列表骨架屏

**模板代码：**

```vue
<div v-if="loading" class="skeleton-container">
  <div v-for="i in 3" :key="i" class="skeleton-card">
    <div class="skeleton-time-row">
      <div class="skeleton-time"></div>
      <div class="skeleton-weather"></div>
    </div>
    <div class="skeleton-title"></div>
    <div class="skeleton-desc"></div>
  </div>
</div>
```

**样式代码：**

```scss
.skeleton-container {
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.skeleton-card {
  background: white;
  border-radius: 14px;
  padding: 16px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.skeleton-time-row {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
}

.skeleton-time {
  width: 50px;
  height: 18px;
  background: linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  border-radius: 4px;
  animation: skeleton-loading 1.5s infinite;
}

.skeleton-weather {
  width: 60px;
  height: 18px;
  background: linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  border-radius: 4px;
  animation: skeleton-loading 1.5s infinite;
}

.skeleton-title {
  width: 70%;
  height: 20px;
  background: linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  border-radius: 4px;
  animation: skeleton-loading 1.5s infinite;
  margin-bottom: 10px;
}

.skeleton-desc {
  width: 90%;
  height: 14px;
  background: linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  border-radius: 4px;
  animation: skeleton-loading 1.5s infinite;
}
```

---

## 二、自定义 Loading 样式

### 2.1 页面级 Loading

用于整页数据加载时的占位展示。

**模板代码：**

```vue
<div v-if="loading" class="page-loading">
  <n-spin size="large" />
  <span class="loading-text">加载中...</span>
</div>
```

**样式代码：**

```scss
.page-loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  gap: 16px;
}

.loading-text {
  font-size: 14px;
  color: #64748b;
}
```

### 2.2 全局遮罩 Loading

用于操作过程中的全局遮罩，阻止用户交互。

**模板代码：**

```vue
<div v-if="processing" class="global-overlay">
  <n-spin size="medium" />
  <span class="global-text">{{ processingText }}</span>
</div>
```

**样式代码：**

```scss
.global-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(4px);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 20px;
  z-index: 99999;
}

.global-overlay .n-spin {
  transform: scale(1.5);
}

.global-text {
  font-size: 18px;
  color: #ff6b6b;
  font-weight: 600;
  letter-spacing: 1px;
}
```

### 2.3 局部遮罩 Loading

用于组件内部的加载遮罩。

**模板代码：**

```vue
<div v-if="loading" class="loading-mask">
  <n-spin size="medium" />
  <span class="loading-text">正在处理...</span>
</div>
```

**样式代码：**

```scss
.loading-mask {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(250, 248, 245, 0.95);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 12px;
  z-index: 10;
  border-radius: 8px;
}

.loading-text {
  font-size: 14px;
  color: #8b7d6b;
  font-weight: 500;
}
```

---

## 三、加减按钮组件

### 3.1 组件实现

**StepButton.vue**

```vue
<template>
  <button
    type="button"
    class="step-button"
    :class="{ 'is-disabled': disabled }"
    :disabled="disabled"
    @click="handleClick"
  >
    <slot>{{ label }}</slot>
  </button>
</template>

<script setup>
const props = defineProps({
  label: {
    type: String,
    default: "",
  },
  disabled: {
    type: Boolean,
    default: false,
  },
});

const emit = defineEmits(["click"]);

function handleClick(e) {
  if (!props.disabled) {
    emit("click", e);
  }
}
</script>

<style scoped>
.step-button {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: 1.5px solid #e8e8e8;
  background: #ffffff;
  color: #666;
  font-size: 16px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  outline: none;
}

.step-button:hover:not(.is-disabled) {
  border-color: #ff6b6b;
  color: #ff6b6b;
}

.step-button:active:not(.is-disabled) {
  background: linear-gradient(135deg, #ff6b6b, #ff8e53);
  border-color: transparent;
  color: #ffffff;
  transform: scale(0.9);
}

.step-button.is-disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
</style>
```

### 3.2 使用示例

```vue
<template>
  <div class="number-input-group">
    <StepButton
      label="-"
      :disabled="value <= min"
      @click="value = Math.max(min, value - 1)"
    />
    <n-input-number
      v-model:value="value"
      :min="min"
      :max="max"
      :show-button="false"
      round
    />
    <StepButton
      label="+"
      :disabled="value >= max"
      @click="value = Math.min(max, value + 1)"
    />
  </div>
</template>

<style scoped>
.number-input-group {
  display: flex;
  align-items: center;
  gap: 8px;
}

.number-input-group :deep(.n-input-number) {
  width: 80px;
}
</style>
```

---

## 四、弹窗组件样式

### 4.1 确认弹窗组件

**ConfirmModal.vue**

```vue
<template>
  <n-modal
    v-model:show="isVisible"
    preset="card"
    :title="title"
    class="confirm-modal"
    :style="modalStyle"
    :header-style="headerStyle"
    :content-style="contentStyle"
    :footer-style="footerStyle"
    @update:show="handleShowUpdate"
  >
    <div class="confirm-content">
      <p class="confirm-text">{{ content }}</p>
    </div>
    <template #footer>
      <div class="confirm-footer">
        <n-button
          class="confirm-btn cancel-btn"
          :disabled="loading"
          @click="handleCancel"
        >
          <template #icon>
            <n-icon :component="CloseOutlined" />
          </template>
          {{ cancelText }}
        </n-button>
        <n-button
          type="primary"
          class="confirm-btn confirm-btn-primary"
          :loading="loading"
          @click="handleConfirm"
        >
          <template #icon>
            <n-icon :component="CheckOutlined" />
          </template>
          {{ confirmText }}
        </n-button>
      </div>
    </template>
  </n-modal>
</template>

<script setup>
import { ref, computed, watch } from "vue";
import { NModal, NButton, NIcon } from "naive-ui";
import { CheckOutlined, CloseOutlined } from "@vicons/antd";

const props = defineProps({
  show: Boolean,
  title: { type: String, default: "确认" },
  content: { type: String, default: "" },
  confirmText: { type: String, default: "确定" },
  cancelText: { type: String, default: "取消" },
  loading: Boolean,
});

const emit = defineEmits(["close", "confirm"]);

const isVisible = ref(false);

watch(
  () => props.show,
  (val) => {
    isVisible.value = val;
  },
);

const modalStyle = computed(() => ({
  width: "400px",
  maxWidth: "90vw",
  borderRadius: "16px",
}));

const headerStyle = computed(() => ({
  background: "linear-gradient(135deg, #ff6b6b, #ff8e53)",
  padding: "14px 20px",
  borderRadius: "16px 16px 0 0",
}));

const contentStyle = computed(() => ({
  padding: "20px",
  background: "#fafafa",
}));

const footerStyle = computed(() => ({
  display: "flex",
  alignItems: "center",
  justifyContent: "space-between",
  padding: "16px 20px",
  background: "#ffffff",
  borderTop: "1px solid #f0f0f0",
  gap: "12px",
  borderRadius: "0 0 16px 16px",
}));

const handleShowUpdate = (val) => {
  if (!val) emit("close");
};

const handleCancel = () => {
  isVisible.value = false;
  emit("close");
};

const handleConfirm = () => {
  emit("confirm");
};
</script>

<style scoped>
.confirm-modal :deep(.n-card) {
  border-radius: 16px !important;
  overflow: hidden !important;
  box-shadow: 0 25px 80px rgba(0, 0, 0, 0.18) !important;
  border: none !important;
}

.confirm-modal :deep(.n-card-header__main) {
  color: #ffffff !important;
  font-size: 17px !important;
  font-weight: 700 !important;
  text-align: center !important;
}

.confirm-content {
  text-align: center;
}

.confirm-text {
  font-size: 15px;
  color: #444;
  line-height: 1.6;
  margin: 0;
}

.confirm-footer {
  display: flex;
  gap: 12px;
  width: 100%;
}

.confirm-btn {
  flex: 1;
  height: 44px;
  border-radius: 16px;
  font-size: 15px;
  font-weight: 500;
}

.cancel-btn {
  border: 1.5px solid #e8e8e8;
  background: #ffffff;
  color: #666;
  transition: all 0.3s ease;
}

.cancel-btn:hover {
  border-color: #ffb8a8;
  color: #ff6b6b;
  background: linear-gradient(135deg, #fff8f6 0%, #fff 100%);
}

.confirm-btn-primary {
  background: linear-gradient(135deg, #ff6b6b, #ff8e53);
  border: none;
  color: #ffffff;
  font-weight: 600;
  box-shadow: 0 4px 14px rgba(255, 107, 107, 0.35);
  transition: all 0.3s ease;
}

.confirm-btn-primary:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 18px rgba(255, 107, 107, 0.45);
}
</style>
```

### 4.2 通用弹窗样式规范

所有弹窗组件应遵循以下样式规范：

```scss
.modal-base {
  border-radius: 16px;
  box-shadow: 0 25px 80px rgba(0, 0, 0, 0.18);
}

.modal-header {
  background: linear-gradient(135deg, #ff6b6b, #ff8e53);
  padding: 14px 20px;
  border-radius: 16px 16px 0 0;
  color: #ffffff;
  font-size: 17px;
  font-weight: 700;
}

.modal-content {
  padding: 20px;
  background: #fafafa;
}

.modal-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  background: #ffffff;
  border-top: 1px solid #f0f0f0;
  gap: 12px;
  border-radius: 0 0 16px 16px;
}
```

### 4.3 弹窗按钮样式

```scss
.btn-secondary {
  flex: 1;
  height: 44px;
  border-radius: 16px;
  border: 1.5px solid #e8e8e8;
  background: #ffffff;
  color: #666;
  font-size: 15px;
  font-weight: 500;
  transition: all 0.3s ease;
}

.btn-secondary:hover {
  border-color: #ffb8a8;
  color: #ff6b6b;
  background: linear-gradient(135deg, #fff8f6 0%, #fff 100%);
}

.btn-primary {
  flex: 1;
  height: 44px;
  border-radius: 16px;
  background: linear-gradient(135deg, #ff6b6b, #ff8e53);
  border: none;
  color: #ffffff;
  font-size: 15px;
  font-weight: 600;
  box-shadow: 0 4px 14px rgba(255, 107, 107, 0.35);
  transition: all 0.3s ease;
}

.btn-primary:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 18px rgba(255, 107, 107, 0.45);
}
```

---

## 五、响应式适配

### 5.1 移动端适配

```scss
@media (max-width: 768px) {
  .modal-header {
    padding: 12px 16px;
  }

  .modal-content {
    padding: 16px;
  }

  .modal-footer {
    padding: 12px 16px;
  }

  .skeleton-grid {
    grid-template-columns: 1fr;
  }
}
```

### 5.2 设备检测 Hook

```javascript
import { ref, onMounted, onUnmounted } from "vue";

export function useDevice() {
  const isMobile = ref(false);

  const checkDevice = () => {
    isMobile.value = window.innerWidth <= 768;
  };

  onMounted(() => {
    checkDevice();
    window.addEventListener("resize", checkDevice);
  });

  onUnmounted(() => {
    window.removeEventListener("resize", checkDevice);
  });

  return { isMobile };
}
```

### 5.3 安全区域适配

针对 iPhone 等设备的刘海屏、底部横条进行适配，使用 `env(safe-area-inset-*)` 函数。

#### 基础安全区域适配

```scss
/* 底部安全区域 */
:root {
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-top: env(safe-area-inset-top);
  --safe-left: env(safe-area-inset-left);
  --safe-right: env(safe-area-inset-right);
}
```

#### 固定底部按钮/操作栏适配

```scss
/* 固定在底部的操作栏 */
.fixed-bottom-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: #fff;
  padding: 16px 20px calc(16px + env(safe-area-inset-bottom));
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
  z-index: 100;
}
```

#### 浮动按钮 (FAB) 适配

```scss
/* 浮动按钮 */
.fab-add-btn {
  position: fixed;
  right: 20px;
  bottom: calc(80px + env(safe-area-inset-bottom));
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: linear-gradient(135deg, #ff9f43, #ff6b6b);
  border: none;
  box-shadow: 0 4px 16px rgba(255, 107, 107, 0.4);
  z-index: 100;
}

.fab-add-btn:hover {
  transform: scale(1.05);
}
```

#### 底部安全区域占位

```vue
<template>
  <div class="page-content">
    <!-- 页面内容 -->
    <div class="bottom-safe-area"></div>
  </div>
</template>

<style scoped>
.bottom-safe-area {
  height: calc(100px + env(safe-area-inset-bottom));
}
</style>
```

#### 左右安全区域适配

```scss
/* 页面左右内边距 */
.hero-inner {
  max-width: 100%;
  padding: 0 max(16px, env(safe-area-inset-left));
}
```

---

## 六、更多基础组件

### 6.1 按钮组件

#### 主按钮样式

```scss
.btn-primary {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  height: 44px;
  padding: 0 24px;
  border-radius: 16px;
  background: linear-gradient(135deg, #ff6b6b, #ff8e53);
  border: none;
  color: #ffffff;
  font-size: 15px;
  font-weight: 600;
  box-shadow: 0 4px 14px rgba(255, 107, 107, 0.35);
  transition: all 0.3s ease;
  cursor: pointer;
}

.btn-primary:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 18px rgba(255, 107, 107, 0.45);
}

.btn-primary:active {
  transform: scale(0.98);
}
```

#### 次按钮样式

```scss
.btn-secondary {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  height: 44px;
  padding: 0 24px;
  border-radius: 16px;
  border: 1.5px solid #e8e8e8;
  background: #ffffff;
  color: #666;
  font-size: 15px;
  font-weight: 500;
  transition: all 0.3s ease;
  cursor: pointer;
}

.btn-secondary:hover {
  border-color: #ffb8a8;
  color: #ff6b6b;
  background: linear-gradient(135deg, #fff8f6 0%, #fff 100%);
}
```

#### 图标按钮样式

```scss
.btn-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: 1.5px solid #e8e8e8;
  background: #ffffff;
  color: #666;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  cursor: pointer;
}

.btn-icon:hover {
  border-color: #ff6b6b;
  color: #ff6b6b;
  background: linear-gradient(135deg, #fff8f6 0%, #fff 100%);
}
```

---

### 6.2 输入框组件

#### 通用输入框样式

```scss
.custom-input {
  :deep(.n-input__wrapper) {
    border-radius: 12px;
    border: 1.5px solid #e8e8e8;
    background: #ffffff;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  :deep(.n-input__wrapper:hover) {
    border-color: #ffb8a8;
    box-shadow: 0 2px 12px rgba(255, 107, 107, 0.08);
  }

  :deep(.n-input__wrapper--focused) {
    border-color: #ff6b6b;
    box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
  }

  :deep(.n-input__input-el) {
    height: 44px;
    font-size: 15px;
  }

  :deep(.n-input__placeholder) {
    color: #bbb;
  }
}
```

#### 文本域样式

```scss
.custom-textarea {
  :deep(.n-input__wrapper) {
    border-radius: 12px;
    border: 1.5px solid #e8e8e8;
    background: #ffffff;
    transition: all 0.3s ease;
  }

  :deep(.n-input__wrapper:hover) {
    border-color: #ffb8a8;
    box-shadow: 0 2px 12px rgba(255, 107, 107, 0.08);
  }

  :deep(.n-input__wrapper--focused) {
    border-color: #ff6b6b;
    box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
  }

  :deep(.n-input__prefix) {
    align-self: flex-start;
    padding-top: 10px;
    color: #ff8e53;
  }
}
```

#### 数字输入框样式

```scss
.custom-input-number {
  :deep(.n-input__wrapper) {
    border-radius: 10px;
    border: 1.5px solid #e8e8e8;
    background: #ffffff;
    transition: all 0.3s ease;
  }

  :deep(.n-input__wrapper:hover) {
    border-color: #ffb8a8;
    box-shadow: 0 2px 12px rgba(255, 107, 107, 0.08);
  }

  :deep(.n-input__wrapper--focused) {
    border-color: #ff6b6b;
    box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
  }

  :deep(.n-input__prefix) {
    color: #ff6b6b;
    font-weight: 600;
  }
}
```

---

### 6.3 卡片组件

#### 基础卡片样式

```scss
.card-base {
  background: #ffffff;
  border-radius: 16px;
  border: 1px solid #f0f0f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.02);
  overflow: hidden;
  transition: all 0.3s ease;
}

.card-base:hover {
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
}
```

#### 表单分区卡片

```vue
<template>
  <div class="form-section">
    <div class="section-header">
      <span class="section-icon">
        <n-icon :component="icon" />
      </span>
      <span class="section-title">{{ title }}</span>
    </div>
    <div class="section-content">
      <slot />
    </div>
  </div>
</template>

<style scoped>
.form-section {
  background: #ffffff;
  border-radius: 16px;
  border
```
: 1px solid #f0f0f0;
  margin-bottom: 10px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.02);
}

.section-header {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 12px;
  background: linear-gradient(135deg, #fff8f6 0%, #fff 100%);
  border-bottom: 1px solid #f0f0f0;
}

.section-icon {
  font-size: 14px;
  color: #ff6b6b;
}

.section-title {
  font-size: 13px;
  font-weight: 600;
  color: #333;
}

.section-content {
  padding: 10px;
}
</style>
```

#### 信息卡片样式

```scss
.info-card {
  background: #ffffff;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 2px 10px rgba(15, 23, 42, 0.06);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  border: 1px solid rgba(0, 0, 0, 0.03);
  cursor: pointer;
}

.info-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 10px 20px rgba(15, 23, 42, 0.12);
}
```

#### 带类型标识的卡片

```scss
.type-card {
  background: #ffffff;
  border-radius: 16px;
  padding: 18px;
  position: relative;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.03);
  border: 1px solid rgba(0, 0, 0, 0.02);
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* 类型标识边框 */
.type-card.transport {
  border-left: 4px solid #4d96ff;
}
.type-card.hotel {
  border-left: 4px solid #ffd93d;
}
.type-card.scenic {
  border-left: 4px solid #ff6b6b;
}
.type-card.food {
  border-left: 4px solid #4d96ff;
}
.type-card.activity {
  border-left: 4px solid #eb2f96;
}
```

---

### 6.4 标签/徽章组件

#### 基础标签样式

```scss
.tag {
  display: inline-flex;
  align-items: center;
  padding: 4px 10px;
  border-radius: 6px;
  font-size: 12px;
  background: #f3f4f6;
  color: #636e72;
  white-space: nowrap;
}

.tag-primary {
  background: linear-gradient(135deg, #ff9f43, #ff6b6b);
  color: white;
  font-weight: 600;
  box-shadow: 0 2px 6px rgba(255, 107, 107, 0.25);
}

.tag-success {
  background: #e8f5e9;
  color: #4caf50;
}

.tag-info {
  background: #e8f4fd;
  color: #1890ff;
}
```

#### 单选按钮组（标签式）

```scss
.radio-group-inline {
  :deep(.n-radio-group__button-group) {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }
}

.radio-btn-standard {
  border-radius: 10px;
  border: 1.5px solid #e8e8e8;
  background: #ffffff;
  color: #666;
  font-size: 14px;
  padding: 8px 16px;
  transition: all 0.3s ease;
}

.radio-btn-standard:hover {
  border-color: #ffb8a8;
  color: #ff6b6b;
  background: linear-gradient(135deg, #fff8f6 0%, #fff 100%);
}

.radio-btn-standard.n-radio-button--checked {
  background: linear-gradient(135deg, #ff6b6b, #ff8e53);
  border-color: transparent;
  color: #ffffff;
  box-shadow: 0 2px 8px rgba(255, 107, 107, 0.25);
}
```

---

### 6.5 表单布局组件

#### 表单行布局

```scss
.form-row {
  display: flex;
  gap: 16px;
  align-items: flex-start;
}

.form-col {
  flex: 1;
  min-width: 0;
}

.form-col-auto {
  flex: 0 0 auto;
}

@media screen and (max-width: 768px) {
  .form-row {
    gap: 12px;
  }
}
```

#### 表单标签样式

```scss
.input-label {
  color: #666;
  font-size: 14px;
  font-weight: 500;
  margin-bottom: 8px;
  display: block;
}

.currency-prefix {
  color: #ff6b6b;
  font-weight: 600;
  font-size: 14px;
}

.input-separator {
  color: #999;
  font-size: 14px;
  padding: 0 4px;
}
```

---

### 6.6 SCSS Mixins（混入）

在 `src/styles/mixins.scss` 中定义：

```scss
// 通用输入框样式
@mixin input-wrapper {
  border-radius: 12px;
  border: 1.5px solid #e8e8e8;
  background: #ffffff;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);

  &:hover {
    border-color: #ffb8a8;
    box-shadow: 0 2px 12px rgba(255, 107, 107, 0.08);
  }

  &--focused {
    border-color: #ff6b6b;
    box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
  }
}

// 通用按钮样式
@mixin btn-base {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  font-weight: 500;
  transition: all 0.3s ease;
  cursor: pointer;
}

// 卡片头部样式
@mixin section-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 16px;
  background: linear-gradient(135deg, #fff8f6 0%, #fff 100%);
  border-bottom: 1px solid #f0f0f0;
}

// 弹性布局工具
@mixin flex-between {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

@mixin flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}
```

---

## 七、组件文件索引

| 组件类型     | 文件路径                             |
| ------------ | ------------------------------------ |
| **基础组件** |                                      |
| 加减按钮     | `src/components/StepButton.vue`      |
| 日期选择按钮 | `src/components/DateRangeButton.vue` |
| 预算输入     | `src/components/BudgetInput.vue`     |
| 天数输入     | `src/components/DayInput.vue`        |
| 表单分区卡片 | `src/components/FormSection.vue`     |
| **弹窗组件** |                                      |
| 确认弹窗     | `src/components/ConfirmModal.vue`    |
| 行程弹窗     | `src/components/TripModal.vue`       |
| 日期选择弹窗 | `src/components/DatePickerModal.vue` |
| **样式文件** |                                      |
| 全局样式变量 | `src/styles/variables.scss`          |
| 组件通用样式 | `src/styles/components.scss`         |
| SCSS Mixins  | `src/styles/mixins.scss`             |
| 认证页面样式 | `src/styles/auth.scss`               |
| 首页样式     | `src/styles/home.scss`               |
| **工具**     |                                      |
| 设备检测     | `src/composables/useDevice.js`       |

---

## 八、快速复用清单

在新项目中复用这些组件时，需要复制的核心文件：

### 必复制文件

1. **样式变量** - `src/styles/variables.scss`
2. **SCSS Mixins** - `src/styles/mixins.scss`
3. **组件通用样式** - `src/styles/components.scss`

### 基础组件（按需复制）

4. **加减按钮** - `src/components/StepButton.vue`
5. **确认弹窗** - `src/components/ConfirmModal.vue`
6. **表单分区卡片** - `src/components/FormSection.vue`

### 样式代码（按需复制）

7. **骨架屏样式** - 复制 `.skeleton-*` 相关样式
8. **Loading样式** - 复制 `.global-overlay`、`.page-loading`、`.loading-mask` 样式
9. **按钮样式** - 复制 `.btn-primary`、`.btn-secondary` 样式
10. **输入框样式** - 复制 `.custom-input`、`.custom-textarea` 样式
11. **卡片样式** - 复制 `.card-base`、`.form-section` 样式
12. **标签样式** - 复制 `.tag`、`.tag-primary` 样式
13. **安全区域适配** - 复制 `env(safe-area-inset-*)` 相关代码

### 工具方法

14. **设备检测** - `src/composables/useDevice.js`

### 依赖安装

```bash
npm install naive-ui @vicons/antd
```

### 主题色快速切换

修改 `src/styles/variables.scss` 中的主色变量：

```scss
/* 红色主题（默认） */
--primary-color: #ff6b6b;
--primary-light: #ff8e53;

/* 蓝色主题 */
--primary-color: #4d96ff;
--primary-light: #6bb6ff;

/* 绿色主题 */
--primary-color: #52c41a;
--primary-light: #73d13d;

/* 紫色主题 */
--primary-color: #722ed1;
--primary-light: #b37feb;
```

---

# 项目架构

---

## 九、项目目录结构

```
src/
├── components/          # 组件目录
│   ├── trip/           # 行程相关组件
│   │   ├── TripCardList.vue
│   │   ├── TripDayTabs.vue
│   │   ├── TripDetailHeader.vue
│   │   └── TripMapCard.vue
│   ├── AuthLayout.vue
│   ├── BudgetInput.vue
│   ├── ConfirmModal.vue
│   ├── DatePickerModal.vue
│   └── ... (更多组件)
├── composables/         # 组合式函数
│   ├── useAMap.js      # 高德地图封装
│   ├── useDevice.ts    # 设备检测
│   ├── useFormHistory.js # 表单历史记录
│   └── useScrollRestore.js # 滚动位置恢复
├── constants/           # 常量定义
│   └── dictionaries.js
├── pages/              # 页面组件
│   ├── Home.vue
│   ├── Login.vue
│   ├── TripDetail.vue
│   ├── Schedule.vue
│   └── ... (更多页面)
├── plugins/            # 插件
│   └── a11y-focus-fix.ts
├── router/             # 路由配置
│   └── index.ts
├── services/           # API 服务
│   └── api.js
├── stores/             # Pinia 状态管理
│   ├── index.js
│   ├── app.js
│   ├── user.js
│   ├── trip.js
│   └── schedule.js
├── styles/             # 样式文件
│   ├── variables.scss
│   ├── mixins.scss
│   └── ... (更多样式)
├── types/              # TypeScript 类型定义
│   ├── api.d.ts
│   ├── stores.d.ts
│   └── trip.ts
├── utils/              # 工具函数
│   ├── storage.js      # localStorage 封装
│   ├── api.js
│   ├── date.ts
│   └── ... (更多工具)
├── App.vue
└── main.ts
```

---

## 十、技术栈

### 核心依赖

```json
{
  "dependencies": {
    "@vicons/antd": "^0.13.0",     // Ant Design 图标库
    "naive-ui": "^2.39.0",          // UI 组件库
    "pinia": "^2.1.7",              // 状态管理
    "qrcode": "^1.5.4",             // 二维码生成
    "sortablejs": "^1.15.7",        // 拖拽排序
    "vue": "^3.3.4",                // Vue 3 框架
    "vue-router": "^4.3.0"          // 路由管理
  },
  "devDependencies": {
    "@vitejs/plugin-vue": "^5.0.0",
    "sass": "1.63.2",
    "sass-loader": "10.4.1",
    "typescript": "^5.4.0",
    "vite": "^5.2.8"
  }
}
```

### 技术栈总结

| 类别 | 技术选型 |
|------|---------|
| **框架** | Vue 3 + TypeScript |
| **构建工具** | Vite 5 |
| **UI 库** | Naive UI |
| **状态管理** | Pinia |
| **路由** | Vue Router 4 |
| **样式** | SCSS |
| **地图** | 高德地图 JSAPI |
| **其他** | QRCode（二维码）、SortableJS（拖拽排序） |

---

## 十一、状态管理 (Pinia Store)

项目采用模块化的 Pinia Store 架构，共有 4 个 Store：

### 11.1 Store 入口文件

```javascript
// src/stores/index.js

import { createPinia } from 'pinia'

export const pinia = createPinia()

export { useUserStore } from './user'
export { useTripStore } from './trip'
export { useScheduleStore } from './schedule'
export { useAppStore } from './app'

export default pinia
```

### 11.2 App Store - 应用全局状态

```javascript
// src/stores/app.js

import { defineStore } from 'pinia'
import { getItem, setItem, getJSON, setJSON } from '@/utils/storage.js'

const SETTINGS_KEY = 'app:settings'

const DEFAULT_SETTINGS = {
  theme: 'light',
  primaryColor: '#ff6b6b',
  enableNotification: true,
  enableSound: true,
  defaultMapType: 'standard',
  showTraffic: false,
  autoClearCache: true,
  cacheRetentionDays: 7,
  compactMode: false,
  showDistance: true,
  showProgress: true,
  shareLocation: false
}

export const useAppStore = defineStore('app', {
  state: () => ({
    settings: loadSettingsFromStorage(),
    networkStatus: { isConnected: true, networkType: 'wifi' },
    systemInfo: null,
    lastVisitedRoute: '',
    isReady: false,
    isBackground: false,
    globalMessage: null
  }),

  getters: {
    isDarkMode: (state) => state.settings.theme === 'dark',
    isOnline: (state) => state.networkStatus.isConnected,
    isWifi: (state) => state.networkStatus.networkType === 'wifi'
  },

  actions: {
    async initApp() { /* 初始化应用 */ },
    updateSettings(newSettings) { /* 更新设置 */ },
    saveSettingsToStorage() { /* 保存设置 */ },
    resetSettings() { /* 重置设置 */ },
    clearCache() { /* 清除缓存 */ }
  }
})
```

### 11.3 User Store - 用户状态

```javascript
// src/stores/user.js

export const useUserStore = defineStore('user', {
  state: () => ({
    token: '',
    userInfo: null,
    isLoggedIn: false,
    loading: false,
    error: null
  }),

  getters: {
    userId: (state) => state.userInfo?.id || '',
    username: (state) => state.userInfo?.username || '',
    avatar: (state) => state.userInfo?.avatar || '',
    email: (state) => state.userInfo?.email || '',
    isEmailVerified: (state) => state.userInfo?.emailVerified || false
  },

  actions: {
    async login(credentials) { /* 登录 */ },
    async logout() { /* 登出 */ },
    async fetchUserInfo() { /* 获取用户信息 */ },
    async updateProfile(profile) { /* 更新资料 */ },
    setToken(token) { /* 设置 Token */ }
  }
})
```

### 11.4 Trip Store - 行程状态

```javascript
// src/stores/trip.js

export const useTripStore = defineStore('trip', {
  state: () => ({
    tripList: [],
    tripListTotal: 0,
    tripListParams: { page: 1, limit: 20 },
    currentTrip: null,
    currentTripDays: [],
    loading: { list: false, detail: false, save: false },
    error: null
  }),

  getters: {
    tripCount: (state) => state.tripList.length,
    currentTripId: (state) => state.currentTrip?.id || '',
    isLoadingList: (state) => state.loading.list,
    getTripById: (state) => (id) => state.tripList.find(trip => trip.id === id)
  },

  actions: {
    async fetchTripList(params, refresh) { /* 获取行程列表 */ },
    async fetchTripDetail(tripId, useCache) { /* 获取行程详情 */ },
    async createTrip(tripData) { /* 创建行程 */ },
    async updateTrip(tripId, tripData) { /* 更新行程 */ },
    async deleteTrip(tripId) { /* 删除行程 */ }
  }
})
```

### 11.5 Schedule Store - 日程状态

```javascript
// src/stores/schedule.js

export const useScheduleStore = defineStore('schedule', {
  state: () => ({
    scheduleData: {},        // { dayId: events[] }
    currentDayId: '',
    locations: [],
    distances: {},
    loading: { schedule: false, save: false },
    error: null
  }),

  getters: {
    currentDayCards: (state) => state.scheduleData[state.currentDayId] || [],
    currentDayCardCount: (state) => (state.scheduleData[state.currentDayId] || []).length,
    completionProgress: (state) => { /* 计算完成进度 */ }
  },

  actions: {
    async fetchSchedule(tripId, dayId, useCache) { /* 获取日程 */ },
    async createEvent(tripId, dayId, eventData) { /* 创建事件 */ },
    async updateEvent(tripId, dayId, eventId, eventData) { /* 更新事件 */ },
    async deleteEvent(tripId, dayId, eventId) { /* 删除事件 */ },
    async reorderEvents(tripId, dayId, orderedEventIds) { /* 重新排序 */ }
  }
})
```

---

## 十二、Composables (组合式函数)

### 12.1 useDevice - 设备检测

```typescript
// src/composables/useDevice.ts

import { ref, onMounted, onUnmounted, type Ref } from 'vue'

const MOBILE_BREAKPOINT = 768

export function useDevice(): { isMobile: Ref<boolean> } {
  const isMobile = ref<boolean>(false)
  let resizeObserver: ResizeObserver | null = null

  const checkDevice = () => {
    isMobile.value = window.innerWidth < MOBILE_BREAKPOINT
  }

  onMounted(() => {
    checkDevice()
    if (typeof ResizeObserver !== 'undefined') {
      resizeObserver = new ResizeObserver(() => checkDevice())
      resizeObserver.observe(document.body)
    } else {
      window.addEventListener('resize', checkDevice)
    }
  })

  onUnmounted(() => {
    if (resizeObserver) resizeObserver.disconnect()
    else window.removeEventListener('resize', checkDevice)
  })

  return { isMobile }
}
```

### 12.2 useFormHistory - 表单历史记录

```javascript
// src/composables/useFormHistory.js

/**
 * 表单输入历史记录管理
 * 自动保存表单输入内容，支持恢复和清除
 */
export function useFormHistory(options = {}) {
  const {
    formId = null,
    initialData = {},
    fields = [],
    debounceMs = 500,
    maxHistory = 10,
    encrypt = false,
    expireDays = 7
  } = options

  return {
    formData,
    history,
    saveHistory,
    restoreHistory,
    restoreAutoSave,
    clearHistory,
    saveToStorage
  }
}

// 单个输入框历史记录
export function useInputHistory(fieldName, options = {}) {
  return {
    inputValue,
    historyIndex,
    showHistoryDropdown,
    historyList,
    navigateHistory,
    selectHistory,
    saveHistory,
    removeHistoryItem,
    clearAllHistory
  }
}
```

### 12.3 useScrollRestore - 滚动位置恢复

```javascript
// src/composables/useScrollRestore.js

/**
 * 页面滚动位置恢复
 * 支持页面刷新后恢复、多个滚动容器、日期导航栏等场景
 */
export function useScrollRestore(options = {}) {
  const {
    container = null,
    immediate = true,
    delay = 300,
    excludeRoutes = [],
    persist = true
  } = options

  return {
    saveScrollPosition,
    restoreScrollPosition,
    clearScrollPosition,
    scrollRef,
    isRestored
  }
}

// 路由 scrollBehavior
export function createScrollBehavior(options = {}) { /* ... */ }
```

### 12.4 useAMap - 高德地图封装

```javascript
// src/composables/useAMap.js

/**
 * 高德地图 SDK 封装 Composable
 */
export function useAMap() {
  return {
    loadAMapSDK,        // 加载 SDK
    initMap,            // 初始化地图
    createPlaceSearch,  // 创建地点搜索
    createAutoComplete, // 创建自动完成
    searchPlace,        // 搜索地点
    searchNearby,       // 周边搜索
    autoCompleteSearch, // 自动完成搜索
    parseLocation,      // 解析位置
    getPoiIcon          // 获取 POI 图标
  }
}
```

---

## 十三、路由配置

### 13.1 路由定义

```typescript
// src/router/index.ts

import { createRouter, createWebHistory, RouteRecordRaw } from 'vue-router'

// 不需要认证的页面白名单
const whiteList = ['/login', '/register', '/forgot-password', '/reset-password', '/verify-email', '/public', '/share']

const routes: RouteRecordRaw[] = [
  { path: '/', name: 'home', component: () => import('@/pages/Home.vue') },
  { path: '/login', name: 'login', component: () => import('@/pages/Login.vue') },
  { path: '/register', name: 'register', component: () => import('@/pages/Register.vue') },
  { path: '/trip/:id', name: 'trip-detail', component: () => import('@/pages/TripDetail.vue') },
  { path: '/trip/:id/schedule', name: 'trip-schedule', component: () => import('@/pages/Schedule.vue') },
  { path: '/trip/:tripId/event', name: 'event-create', component: () => import('@/pages/Event.vue') },
  { path: '/trip/:tripId/event/:eventId', name: 'event-edit', component: () => import('@/pages/Event.vue') },
  { path: '/location-picker', name: 'location-picker', component: () => import('@/pages/LocationPicker.vue') },
  { path: '/option-edit', name: 'option-edit', component: () => import('@/pages/OptionEdit.vue') },
  { path: '/public/:id', name: 'public-trip', component: () => import('@/pages/PublicTrip.vue') },
  { path: '/share/:token', name: 'share-trip', component: () => import('@/pages/PublicTrip.vue') },
  { path: '/profile', name: 'profile', component: () => import('@/pages/Profile.vue') },
  { path: '/profile/edit', name: 'edit-profile', component: () => import('@/pages/EditProfile.vue') },
  { path: '/forgot-password', name: 'forgot-password', component: () => import('@/pages/ForgotPassword.vue') },
  { path: '/reset-password', name: 'reset-password', component: () => import('@/pages/ResetPassword.vue') },
  { path: '/verify-email', name: 'verify-email', component: () => import('@/pages/VerifyEmail.vue') },
  { path: '/:pathMatch(.*)*', name: 'not-found', component: () => import('@/pages/NotFound.vue') }
]

const router = createRouter({
  history: createWebHistory(),
  routes,
  scrollBehavior: createScrollBehavior()
})
```

### 13.2 路由守卫

```typescript
// 全局前置守卫 - 统一处理认证
router.beforeEach((to, from, next) => {
  const token = getToken()
  const requiresAuth = isAuthRequired(to.path)

  // 已登录用户访问登录页，重定向到首页
  if (token && whiteList.includes(to.path)) {
    next('/')
    return
  }

  // 未登录用户访问需要认证的页面，重定向到登录页
  if (requiresAuth && !token) {
    next(`/login?returnUrl=${encodeURIComponent(to.fullPath)}`)
    return
  }

  next()
})
```

### 13.3 路由特性

| 特性 | 说明 |
|------|------|
| **History 模式** | 使用 HTML5 History 模式 |
| **懒加载** | 路由组件动态 import |
| **认证守卫** | 全局前置守卫统一处理 |
| **白名单机制** | 无需认证的页面列表 |
| **滚动恢复** | 自动恢复滚动位置 |

---

## 十四、数据持久化方案

### 14.1 Storage 工具封装

```javascript
// src/utils/storage.js

/**
 * 获取值
 */
export function getItem(key) {
  const storage = getStorage()
  if (!storage) return null
  try {
    return storage.getItem(key)
  } catch (e) {
    console.error('[storage] getItem error:', key, e)
    return null
  }
}

/**
 * 设置值
 */
export function setItem(key, value) {
  const storage = getStorage()
  if (!storage) return
  try {
    storage.setItem(key, value)
  } catch (e) {
    console.error('[storage] setItem error:', key, e)
  }
}

/**
 * 移除值
 */
export function removeItem(key) {
  const storage = getStorage()
  if (!storage) return
  try {
    storage.removeItem(key)
  } catch (e) {
    console.error('[storage] removeItem error:', key, e)
  }
}

/**
 * 获取 JSON 对象
 */
export function getJSON(key) {
  const raw = getItem(key)
  if (!raw) return null
  try {
    return JSON.parse(raw)
  } catch (e) {
    console.error('[storage] getJSON parse error:', key, e)
    return null
  }
}

/**
 * 设置 JSON 对象
 */
export function setJSON(key, value) {
  try {
    setItem(key, JSON.stringify(value))
  } catch (e) {
    console.error('[storage] setJSON error:', key, e)
  }
}
```

### 14.2 持久化使用场景

| 存储键 | 用途 | Store |
|--------|------|-------|
| `token` | 用户登录令牌 | UserStore |
| `userInfo` | 用户信息 JSON | UserStore |
| `rememberMe` | 记住登录状态 | UserStore |
| `savedEmail` | 保存的邮箱 | UserStore |
| `app:settings` | 应用设置 | AppStore |
| `scroll_positions:*` | 滚动位置 | useScrollRestore |
| `form_history:*` | 表单历史 | useFormHistory |
| `input_history:*` | 输入历史 | useInputHistory |

### 14.3 持久化策略

| 数据类型 | 持久化方式 | 过期策略 |
|---------|-----------|---------|
| 用户认证数据 | Token + userInfo 持久化 | 手动清除 |
| 应用设置 | 自动保存到 Storage | 永久保存 |
| 滚动位置 | 7天过期 | 自动清理 |
| 表单历史 | 可配置过期时间 | 自动防抖保存 |
| 缓存数据 | 提供清除功能 | 保留关键数据 |

---

## 十五、项目初始化清单

在新项目中复用此架构时，按以下顺序初始化：

### 15.1 创建项目

```bash
npm create vite@latest my-project -- --template vue-ts
cd my-project
```

### 15.2 安装依赖

```bash
npm install naive-ui @vicons/antd pinia vue-router qrcode sortablejs
npm install -D sass
```

### 15.3 复制核心文件

1. **样式文件** - `src/styles/` 目录
2. **Store 结构** - `src/stores/` 目录
3. **Composables** - `src/composables/` 目录
4. **工具函数** - `src/utils/storage.js`
5. **基础组件** - 按需复制 `src/components/` 中的组件

### 15.4 配置入口文件

```typescript
// main.ts
import { createApp } from 'vue'
import App from './App.vue'
import router from './router'
import pinia from './stores'
import './styles/index.scss'

const app = createApp(App)
app.use(pinia)
app.use(router)
app.mount('#app')
```

---

## 十六、架构总结

这是一个基于 **Vue 3 + Vite + Pinia + Naive UI** 的旅行规划 Web 应用，架构特点：

| 特点 | 说明 |
|------|------|
| **模块化 Store** | 4 个独立的 Pinia Store 管理不同业务域 |
| **可复用 Composables** | 封装设备检测、表单历史、滚动恢复、地图等功能 |
| **完善的持久化** | localStorage 封装 + 过期清理机制 |
| **路由守卫** | 统一的认证和滚动位置恢复 |
| **TypeScript 支持** | 渐进式类型化 |
| **组件化设计** | 统一的 UI 风格和交互体验 |
